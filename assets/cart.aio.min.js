/*
Generated time: September 26, 2024 12:18
This file was created by the app developer. Feel free to contact the original developer with any questions. It was minified (compressed) by AVADA. AVADA do NOT own this script.
*/
class CartRemoveButton extends HTMLElement{constructor(){super(),this.addEventListener("click",e=>{e.preventDefault(),(this.closest("cart-items")||this.closest("cart-drawer-items")).updateQuantity(this.dataset.index,0)})}}customElements.define("cart-remove-button",CartRemoveButton);class CartItems extends HTMLElement{constructor(){super(),this.lineItemStatusElement=document.getElementById("shopping-cart-line-item-status")||document.getElementById("CartDrawer-LineItemStatus"),document.querySelector(".cart-shipping")&&(this.minSpend=document.querySelector(".cart-shipping").dataset.minSpend,this.minTotal=Math.round(this.minSpend*(Shopify.currency.rate||1)),this.cartShipping());var e=debounce(e=>{this.onChange(e)},ON_CHANGE_DEBOUNCE_TIMER);this.addEventListener("change",e.bind(this))}cartUpdateUnsubscriber=void 0;cartShipping(){var e=getComputedStyle(document.querySelector(".cart-shipping__progress-current")).getPropertyValue("width");document.documentElement.style.setProperty("--progress-prev",e),this.total=document.querySelector(".cart-shipping").dataset.total,this.progress=this.total/this.minTotal*100,100<this.progress&&(this.progress=100),(this.minTotal>this.total?(e=this.minTotal-this.total,e=document.querySelector(".cart-shipping").dataset.message.replace("||amount||",formatMoney(e)),document.querySelector(".cart-shipping__message_default").innerText=e,document.querySelector(".cart-shipping__message_success").classList.remove("active"),document.querySelector(".cart-shipping__message_default")):(document.querySelector(".cart-shipping__message_default").classList.remove("active"),document.querySelector(".cart-shipping__message_success"))).classList.add("active"),document.querySelector(".cart-shipping__progress-current").style.width=this.progress+"%"}connectedCallback(){this.cartUpdateUnsubscriber=subscribe(PUB_SUB_EVENTS.cartUpdate,e=>{"cart-items"!==e.source&&this.onCartUpdate()})}disconnectedCallback(){this.cartUpdateUnsubscriber&&this.cartUpdateUnsubscriber()}onChange(e){this.updateQuantity(e.target.dataset.index,e.target.value,document.activeElement.getAttribute("name"))}onCartUpdate(){fetch(routes.cart_url+"?section_id=main-cart-items").then(e=>e.text()).then(e=>{e=(new DOMParser).parseFromString(e,"text/html").querySelector("cart-items");this.innerHTML=e.innerHTML}).catch(e=>{console.error(e)})}getSectionsToRender(){return[{id:"main-cart-items",section:document.getElementById("main-cart-items").dataset.id,selector:".js-contents"},{id:"cart-icon-bubble",section:"cart-icon-bubble",selector:".shopify-section"},{id:"cart-live-region-text",section:"cart-live-region-text",selector:".shopify-section"},{id:"main-cart-footer",section:document.getElementById("main-cart-footer").dataset.id,selector:".js-contents-totals"},{id:"main-cart-shipping",section:document.getElementById("main-cart-shipping").dataset.id||null,selector:".js-contents-shipping"}]}updateQuantity(i,e,c){this.enableLoading(i),this.querySelectorAll(".quantity__button").forEach(e=>e.classList.add("disabled")),document.querySelectorAll('.card--product card__add-to-cart button[name="add"]')&&document.querySelectorAll('.card--product .card__add-to-cart button[name="add"]').forEach(e=>{e.setAttribute("aria-disabled",!1),e.querySelector("span")&&(e.querySelector("span").classList.remove("hidden"),e.querySelector(".sold-out-message").classList.add("hidden"))}),document.querySelector(".cart-shipping")&&(t=getComputedStyle(document.querySelector(".cart-shipping__progress-current")).getPropertyValue("width"),document.documentElement.style.setProperty("--progress-prev",t));var t=JSON.stringify({line:i,quantity:e,sections:this.getSectionsToRender().map(e=>e.section),sections_url:window.location.pathname});fetch(""+routes.cart_change_url,{...fetchConfig(),body:t}).then(e=>e.text()).then(t=>{let r=JSON.parse(t);var t=document.getElementById("Quantity-"+i)||document.getElementById("Drawer-quantity-"+i),a=document.querySelectorAll(".cart-item");if(r.errors)t.value=t.getAttribute("value"),this.updateLiveRegions(i,r.errors);else{this.classList.toggle("is-empty",0===r.item_count);var s=document.querySelector("cart-drawer"),n=document.getElementById("main-cart-footer"),n=(n&&n.classList.toggle("is-empty",0===r.item_count),s&&s.classList.toggle("is-empty",0===r.item_count),this.getSectionsToRender().forEach(e=>{(document.getElementById(e.id).querySelector(e.selector)||document.getElementById(e.id)).innerHTML=this.getSectionInnerHTML(r.sections[e.section],e.selector)}),r.items[i-1]?r.items[i-1].quantity:void 0);let e="";a.length===r.items.length&&n!==parseInt(t.value)&&(e=void 0===n?window.cartStrings.error:window.cartStrings.quantityError.replace("[quantity]",n)),this.updateLiveRegions(i,e);a=document.getElementById("CartItem-"+i)||document.getElementById("CartDrawer-Item-"+i);a&&a.querySelector(`[name="${c}"]`)?s?trapFocus(s,a.querySelector(`[name="${c}"]`)):a.querySelector(`[name="${c}"]`).focus():0===r.item_count&&s?trapFocus(s.querySelector(".drawer__inner-empty"),s.querySelector("a")):document.querySelector(".cart-item")&&s&&trapFocus(s,document.querySelector(".cart-item__name")),publish(PUB_SUB_EVENTS.cartUpdate,{source:"cart-items"})}}).catch(()=>{this.querySelectorAll(".loading-overlay").forEach(e=>e.classList.add("hidden")),this.querySelectorAll(".quantity__button").forEach(e=>e.classList.remove("disabled")),(document.getElementById("cart-errors")||document.getElementById("CartDrawer-CartErrors")).textContent=window.cartStrings.error}).finally(()=>{this.querySelectorAll(".quantity__button").forEach(e=>e.classList.remove("disabled")),document.querySelector(".cart-shipping")&&this.cartShipping(),this.disableLoading(i)})}updateLiveRegions(e,t){e=document.getElementById("Line-item-error-"+e)||document.getElementById("CartDrawer-LineItemError-"+e);e&&(e.querySelector(".cart-item__error-text").innerHTML=t),this.lineItemStatusElement.setAttribute("aria-hidden",!0);let r=document.getElementById("cart-live-region-text")||document.getElementById("CartDrawer-LiveRegionText");r.setAttribute("aria-hidden",!1),setTimeout(()=>{r.setAttribute("aria-hidden",!0)},1e3)}getSectionInnerHTML(e,t){return(new DOMParser).parseFromString(e,"text/html").querySelector(t).innerHTML}enableLoading(e){(document.getElementById("main-cart-items")||document.getElementById("CartDrawer-CartItems")).classList.add("cart__items--disabled");var t=this.querySelectorAll(`#CartItem-${e} .loading-overlay`),e=this.querySelectorAll(`#CartDrawer-Item-${e} .loading-overlay`);[...t,...e].forEach(e=>e.classList.remove("hidden")),document.activeElement.blur(),this.lineItemStatusElement.setAttribute("aria-hidden",!1)}disableLoading(e){(document.getElementById("main-cart-items")||document.getElementById("CartDrawer-CartItems")).classList.remove("cart__items--disabled");var t=this.querySelectorAll(`#CartItem-${e} .loading-overlay`),e=this.querySelectorAll(`#CartDrawer-Item-${e} .loading-overlay`);t.forEach(e=>e.classList.add("hidden")),e.forEach(e=>e.classList.add("hidden"))}}customElements.define("cart-items",CartItems),customElements.get("cart-note")||customElements.define("cart-note",class extends HTMLElement{constructor(){super(),this.addEventListener("change",debounce(e=>{e=JSON.stringify({note:e.target.value});fetch(""+routes.cart_update_url,{...fetchConfig(),body:e})},ON_CHANGE_DEBOUNCE_TIMER))}});